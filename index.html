<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/node_modules/kaboom/dist/kaboom.js"></script>
  <title>Document</title>
</head>

<body>
  <script>
    const tile = 64
    const row = 8
    const col = 8
    const canvas_width = tile * row
    const canvas_height = tile * col
    let cooldown = false

    kaboom({
      width: canvas_width,
      height: canvas_height
    })

    loadSprite('hero','/assets/sprites/dark_hair_boy_60x60.png',
    {
      sliceX: 18,
      anims: {
        run: {
          from: 12,
          to: 15
        }
      }
    })

    for (c = 0; c < col; c++) {
      for (r = 0; r < row; r++) {
        cX = r * tile
        rY = c * tile

        tiles = add([
          rect(tile, tile),
          pos(cX, rY),
          outline(1),
          'tiles'
        ])
      }
    }
    let allTiles = get('tiles')
    let countY = 0
    let countX = 0

    hero = add([
      sprite('hero'),
      pos(0, 0),
      area(),

    ])
    tail = add([
      rect(tile, tile),
      pos(-64, 0),
      outline(1),
      color(RED),
      area(),

    ])




    onKeyPress('down', () => {
      if (countY <= col * (col - 2) && cooldown == false) {
        
        countY += col
        allTiles[countY + countX].color = MAGENTA
        allTiles[countY - col + countX].color = WHITE
        cooldown = true
        move = setInterval(() => {
          if (hero.pos.y <= allTiles[countY + countX].pos.y) {
            hero.move(0, 200)

          }
          else {

            clearInterval(move)
            setTimeout(() => { cooldown = false }, 1)
          }
        }, 1)
      }

    })
    onKeyPress('up', () => {
      if (countY >= 1 && cooldown == false) {
        countY -= col
        allTiles[countY + countX].color = MAGENTA
        allTiles[countY + col + countX].color = WHITE
        cooldown = true
        move = setInterval(() => {
          if (hero.pos.y >= allTiles[countY + countX].pos.y) {
            hero.move(0, -200)

          }
          else {
            setTimeout(() => { cooldown = false }, 1)
            clearInterval(move)


          }
        }, 1)

      }

    })


    onKeyPress('right', () => {

      if (countX <= row - 2 && cooldown == false) {
        hero.play('run')
        countX++
        allTiles[countY + countX].color = MAGENTA
        allTiles[countX - 1 + countY].color = WHITE
        cooldown = true
        hero.flipX(0)

        move = setInterval(() => {
          if (hero.pos.x <= allTiles[countY + countX].pos.x) {
            hero.move(200, 0)


          }
          else {
            setTimeout(() => { cooldown = false }, 1)

            clearInterval(move)

          }
        }, 1)
      }

    })


    onKeyPress('left', () => {
      if (countX >= 1 && cooldown == false) {
        countX--
        allTiles[countY + countX].color = MAGENTA
        allTiles[countX + 1 + countY].color = WHITE
        cooldown = true


        move = setInterval(() => {
          if (hero.pos.x >= allTiles[countY + countX].pos.x) {
            hero.move(-200, 0)

          }
          else {
            clearInterval(move)
            setTimeout(() => { cooldown = false }, 1)

          }

        }, 1)
      }
    })





  </script>
</body>

</html>